# Local FSH Validation

This directory contains validation tools for testing FSH files locally using SUSHI.

## Prerequisites

You need to have SUSHI installed:

```bash
npm install -g fsh-sushi
```

## Two-Step Workflow

### Step 1: Generate FHIR Resources

First, generate FHIR resources to `debug/generated/`:

```bash
python3 debug/generate_fhir.py
# or
./debug/generate.sh
```

This runs SUSHI and copies all generated FHIR resources to `debug/generated/`.

### Step 2: Validate

Then validate your FSH files and check the generated resources:

```bash
python3 debug/validate_fsh.py
# or
./debug/validate.sh
```

This performs lightweight FSH validation and checks the generated files.

## What it does

### Generate Script (`generate_fhir.py`)

1. âœ… Checks if SUSHI is installed
2. ğŸ§¹ Cleans previous `debug/generated/` files
3. ğŸ£ Runs SUSHI to generate FHIR resources
4. ğŸ“ Copies generated files to `debug/generated/`
5. ğŸ“Š Shows summary of generated resources

### Validate Script (`validate_fsh.py`)

1. âœ… Checks if SUSHI is installed
2. ï¿½ Runs lightweight FSH syntax validation
3. ğŸ“‹ Validates generated files in `debug/generated/`
4. âœ“ Checks JSON structure of resources

## Generated Files

All files generated by SUSHI are stored in `debug/generated/`:

- `debug/generated/resources/` - FHIR resource JSON files
- `debug/generated/includes/` - Include files
- `debug/generated/data/` - Data files

**Important:** The `debug/generated/` directory is in `.gitignore` and will
never be committed. These files are for local testing only.

## Output

The script provides colored output with:
- âœ… Success messages
- âš ï¸  Warnings
- âŒ Errors
- ğŸ” Progress indicators

## Example

### Generate Resources

```bash
$ python3 debug/generate_fhir.py

================================================================================
  FHIR Resource Generator - 2025-11-06 14:30:00
================================================================================

âœ… SUSHI is installed: SUSHI v3.x.x (...)
ğŸ” Cleaning debug/generated folder...
âœ… Cleaned previous generated files
ğŸ” Running SUSHI to generate FHIR resources...

[SUSHI output appears here]

âœ… SUSHI generation completed successfully
âœ… Copied 45 FHIR resource files
âœ… Copied includes folder
âœ… Copied data folder

ğŸ“Š Total files generated: 45

ğŸ“ Files by type:
   StructureDefinition: 20
   Patient: 8
   ...

ğŸ’¾ Location: debug/generated
   (gitignored - local testing only)

================================================================================
  Generation Complete
================================================================================

âœ… FHIR resources generated successfully!

ğŸ“‚ Generated files: debug/generated
   Use these files for local testing and validation
   (These files are gitignored and won't be committed)
```

### Validate Files

```bash
$ python3 debug/validate_fsh.py

================================================================================
  FSH Validation - 2025-11-06 14:32:00
================================================================================

This script validates FSH syntax and checks generated files.
To generate files first, run: ./debug/generate_fhir.py

âœ… SUSHI is installed: SUSHI v3.x.x (...)
ğŸ” Running FSH syntax validation...

[SUSHI output appears here]

âœ… FSH validation completed successfully
ğŸ” Validating local generated files...
âœ… Found 45 generated FHIR resources
ğŸ” Validating JSON structure...
âœ… All 45 files have valid JSON structure

================================================================================
  Validation Complete
================================================================================

âœ… All validations passed!

ï¿½ Generated files: debug/generated/
   These files are gitignored for local testing only
```
